a,a___b,a__b__c というようなindexの階層構造をもったdfがあります。これは、製造業のBOMであり、 aの子供にbというassemblyがあり、bの子供にcというassemblyがあります。 
aの個数は3個/itemで、bの個数は1個/itemで、cの個数は、10個/itemとなっています。 
このような階層構造が沢山あります。

この部品を作るにあたり、各々の部品の必要手配個数を求めたいです。

計算式と必要数をdfの列に追加するpythonプログラムを作成してください

上記の例では、cの部品は、 3*1*10 で 30個となります。